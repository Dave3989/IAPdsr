function sAddClicked(){sClearForm(),document.getElementById("sSaleList").value="",document.getElementById("snewcnews").checked=!1,document.getElementById("scposscon").checked=!1,document.getElementById("scposspar").checked=!1,document.getElementById("SUPDATETYPE").value="NEW",document.getElementById("stypeparty").checked=!0,sTurnPOn(),document.getElementById("scustomers").readOnly=!1,document.getElementById("sError").style.display="none",document.getElementById("sdetail").style.display="inline",document.getElementById("srefundbtn").style.display="none",document.getElementById("scustomers").focus()}function sGoClicked(){}function sSelectClicked(){if(""==document.getElementById("sSaleList").value)return!(document.getElementById("sError").style.display="inline");var e=document.getElementById("sSelect").value;if(""==document.getElementById("sSaleList").value)document.getElementById("sError").style.display="inline",document.getElementById("sSaleList").focus();else{e=sSale.item.saleid;sSale=iapPrepCall("/Ajax/iapGetDB","S#",e,sProcSale),document.getElementById("sSaleList").value="",document.getElementById("sError").style.display="none",document.getElementById("sdetail").style.display="inline",document.getElementById("scustomers").readOnly=!0,document.getElementById("srefundbtn").style.display="inline",document.getElementById("scustomers").focus()}}function sProcSale(e){if(sClearForm(),e<0)return e;if(0==e)return document.getElementById("SUPDATETYPE").value="NEW",document.getElementById("SALEID").value="",0;switch(document.getElementById("SPEID").value=e.sale_peid,document.getElementById("SNEWPE").value="N","Y"==e.cust_followup_consultant&&(document.getElementById("scposscon").checked=!0),"Y"==e.cust_followup_party&&(document.getElementById("scposspar").checked=!0),e.sale_type){case"P":document.getElementById("stypeparty").checked=!0,document.getElementById("help29114").style.display="inline";break;case"E":document.getElementById("stypeevent").checked=!0,document.getElementById("help29114").style.display="inline";break;case"I":document.getElementById("stypeindiv").checked=!0,document.getElementById("help29114").style.display="none";break;case"F":document.getElementById("stypefacebk").checked=!0,document.getElementById("help29114").style.display="none";break;case"W":document.getElementById("stypeweb").checked=!0,document.getElementById("help29114").style.display="none";break;case"O":document.getElementById("stypeother").checked=!0,document.getElementById("help29114").style.display="none";break;default:document.getElementById("stypeparty").checked=!0,document.getElementById("help29114").style.display="none"}if(sSetType(e.sale_type),"E"==e.sale_type){var t=moment(e.pe_date).format("MM/DD/YYYY")+" event at "+e.pe_sponsor;document.getElementById("SDATE").value=moment(e.pe_date).format("MM/DD/YYYY"),document.getElementById("speevent").value=t}else{if(""!=e.pe_party_no){t=moment(e.pe_date).format("MM/DD/YYYY")+" "+e.pe_party_no+" "+e.pe_sponsor;document.getElementById("SDATE").value=moment(e.pe_date).format("MM/DD/YYYY"),document.getElementById("speparty").value=t}"P"!=e.sale_type&&(document.getElementById("ssaledate").value=moment(e.sale_date).format("MM/DD/YYYY"),document.getElementById("SDATE").value=moment(e.sale_date).format("MM/DD/YYYY"),document.getElementById("smileage").value=number_format(e.sale_mileage,2,".",","),document.getElementById("sotherexp").value=number_format(e.sale_other_exp,2,".",","),document.getElementById("sexpexplain").value=e.sale_exp_explained,document.getElementById("ssaleloc").value=e.sale_location)}document.getElementById("svendord").value=e.sale_vendor_order,0<e.sale_items&&iapPrepCall("/Ajax/iapGetDB","SD",e.sale_id,sProcSaleDet),document.getElementById("snetsale").value=number_format(e.sale_net,2,".",","),document.getElementById("STAXREGION").value=e.sale_tax_region,document.getElementById("STAXRATE").value=e.sale_tax_rate,document.getElementById("staxregion").innerHTML=e.sale_tax_region,document.getElementById("staxrate").value=number_format(100*e.sale_tax_rate,2,".",","),document.getElementById("staxamt").value=number_format(e.sale_sales_tax,2,".",","),document.getElementById("sshipping").value=number_format(e.sale_shipping,2,".",","),document.getElementById("strackno").value=e.sale_tracking_no,document.getElementById("stotalsale").value=number_format(e.sale_total_amt,2,".",","),"$"==e.sale_pay_method?(document.getElementById("spaycash").checked=!0,document.getElementById("spaychkno").value=""):"C"==e.sale_pay_method?(document.getElementById("spaycredit").checked=!0,document.getElementById("spaychkno").value=""):"K"==e.sale_pay_method&&(document.getElementById("spaycheck").checked=!0,document.getElementById("spaychkno").value=e.sale_check_number),document.getElementById("scomment").value=e.sale_comment;var n=document.getElementById("sprtreclink").href,l=n.indexOf("&"),d=n.substring(0,l)+"&co="+e.sale_company+"&s="+e.sale_id;return document.getElementById("sprtreclink").href=d,document.getElementById("sprtrec").style.display="inline",document.getElementById("SUPDATETYPE").value="EXISTING",document.getElementById("SALEID").value=e.sale_id,!(document.getElementById("sdetail").style.display="inline")}function sProcSaleDet(e){if(e<0)return e;if(0==e)return e;var t=0,n="";for(t=0;t<e.length;t++)n=e[t],sClearItem(),document.getElementById("sitemcode").value=n.saledet_item_code,n.CO_DESC?n.saledet_desc=n.CO_DESC:n.saledet_desc=n.SUPP_DESC,document.getElementById("sitemdesc").value=n.saledet_desc,document.getElementById("sitemqty").value=number_format(n.saledet_quantity,0,".",","),document.getElementById("sitemprice").value=number_format(n.saledet_price,2,".",","),document.getElementById("STHISITEMSOURCE").value=n.saledet_item_source,document.getElementById("STHISITEMSTATUS").value="EXISTING",sRecordItem()}function selectOptionByValue(e,t){for(var n=0;n<e.options.length;n++)if(e.options[n].value===t){e.selectedIndex=n;break}}function selectOptionByHTML(e,t){for(var n=0;n<e.options.length;n++)if(e.options[n].innerHTML===t){e.selectedIndex=n;break}}function sRefundSale(){return 0!=document.getElementById("SALEID").value&&!!confirm("Are you sure you want to refund this sale?")}function sPrintSale(e,t){var n="MyReports/IAPSaleRec.php?action=selected&co="+e+"&s="+t+" target='_blank'";return sPrtWindow=window.open(n,"_blank"),sPrtWindow.focus(),!1}function sClearNewCust(){document.getElementById("iapNewCust").style.display="none",document.getElementById("snewcustlbl").innerHTML="Please provide the following information about the new customer. This new customer will need to be editted later to enter any additional information.",document.getElementById("snewcustlbl").style.color="#666666",document.getElementById("snewcname").value="",document.getElementById("snewcstrt").value="",document.getElementById("snewccity").value="",document.getElementById("snewcstate").value="",document.getElementById("snewczip").value="",document.getElementById("snewcemail").value="",document.getElementById("snewcphone").value="",document.getElementById("snewcbirth").value="",document.getElementById("snewcnews").checked=!0,document.getElementById("scposscon").checked=!1,document.getElementById("scposspar").checked=!1,document.getElementById("staxregion").innerHTML=document.getElementById("SCOTAXREGION").value;var e=document.getElementById("SCOTAXRATE").value;document.getElementById("staxrate").value=number_format(100*e,2,".",","),document.getElementById("STAXREGION").value=document.getElementById("SCOTAXREGION").value,document.getElementById("STAXRATE").value=document.getElementById("SCOTAXRATE").value}function sAddCustomer(){sClearNewCust(),document.getElementById("scustomers").value="",document.getElementById("scustomers").readOnly=!1,document.getElementById("SNEWCUST").value="Y",document.getElementById("iapNewCust").style.display="inline",document.getElementById("snewcname").focus()}function iapChkNewCustomer(){var e=document.getElementById("snewcname").value;sNewCustRet=iapPrepCall("/Ajax/iapGetDB","CN",e,sProcNewCust)}function sProcNewCust(e){if(e<0)return e;0==e?document.getElementById("snewcstrt").focus():(document.getElementById("cError").innerHTML="\nA customer by the new name entered already exists.",document.getElementById("cError").style.display="inline",document.getElementById("scustomers").value=document.getElementById("snewcname").value,sClearNewCust(),document.getElementById("SNEWCUST").value="N",document.getElementById("scustomers").focus())}function sSelCustomer(){var e=document.getElementById("scustomers").value;sClearNewCust(),document.getElementById("scustomers").value=e,document.getElementById("SNEWCUST").value="N",document.getElementById("iapNewCust").style.display="none",sCustRet=iapPrepCall("/Ajax/iapGetDB","CN",e,sProcCust)}function sProcCust(e){return e<0?e:0==e?(document.getElementById("cError").innerHTML="\nThe customer was not found. Retry or click Add.",document.getElementById("cError").style.display="inline",document.getElementById("scustomers").focus(),!1):("Y"==e.cust_followup_consultant&&(document.getElementById("scposscon").checked=!0),"Y"==e.cust_followup_party&&(document.getElementById("scposspar").checked=!0),document.getElementById("cError").style.display="none",!0)}function sSetType(e){switch(e){case"P":document.getElementById("snewpenamelbl").innerHTML="Hostess:",document.getElementById("STYPE").value="Party",document.getElementById("snewpecmt1").innerHTML="party",document.getElementById("snewpecmt2").innerHTML="party",document.getElementById("help29114").style.display="inline",sTurnPOn();break;case"E":document.getElementById("snewpenamelbl").innerHTML="Sponsor:",document.getElementById("STYPE").value="Event",document.getElementById("snewpecmt1").innerHTML="event",document.getElementById("snewpecmt2").innerHTML="event",document.getElementById("help29114").style.display="inline",sTurnEOn();break;case"I":document.getElementById("STYPE").value="Indivdual",document.getElementById("help29114").style.display="none",sTurnPEOff();break;case"F":document.getElementById("STYPE").value="Facebook",document.getElementById("help29114").style.display="none",sTurnPEOff();break;case"W":document.getElementById("STYPE").value="Web",document.getElementById("help29114").style.display="none",document.getElementById("spaycash").checked=!1,document.getElementById("spaycredit").checked=!0,sTurnPEOff(),sTurnIOn();break;case"O":document.getElementById("STYPE").value="Other",document.getElementById("help29114").style.display="none",sTurnPEOff(),sTurnIOn()}}function sTurnPOn(){sClearNewPE(),document.getElementById("iapNewPE").style.display="none",document.getElementById("snonpediv1").style.display="none",document.getElementById("snonpediv2").style.display="none",document.getElementById("snonpediv3").style.display="none",document.getElementById("spelabel").innerHTML="Select a Party: ",document.getElementById("saddpe").innerHTML="New Party",document.getElementById("SDATE").value=document.getElementById("speparty").value,document.getElementById("speevent").style.display="none",document.getElementById("speparty").style.display="inline"}function sTurnEOn(){sClearNewPE(),document.getElementById("iapNewPE").style.display="none",document.getElementById("snonpediv1").style.display="none",document.getElementById("snonpediv2").style.display="none",document.getElementById("snonpediv3").style.display="none",document.getElementById("spelabel").innerHTML="Select an Event: ",document.getElementById("saddpe").innerHTML="New Event",document.getElementById("SDATE").value=document.getElementById("speevent").value,document.getElementById("speparty").style.display="none",document.getElementById("speevent").style.display="inline"}function sTurnPEOff(){sClearNewPE(),document.getElementById("iapNewPE").style.display="none",document.getElementById("spelabel").innerHTML="Select a Party: ",document.getElementById("saddpe").innerHTML="New Party",document.getElementById("SDATE").value=document.getElementById("ssaledate").value,document.getElementById("speevent").style.display="none",document.getElementById("speparty").style.display="inline",document.getElementById("snonpediv1").style.display="inline",document.getElementById("snonpediv2").style.display="inline",document.getElementById("snonpediv3").style.display="none"}function sTurnIOn(){document.getElementById("snonpediv3").style.display="inline"}function sClearNewPE(){document.getElementById("iapNewPE").style.display="none",document.getElementById("snewpename").value="",document.getElementById("snewpedate").value="",document.getElementById("snewpestrt").value="",document.getElementById("snewpecity").value="",document.getElementById("snewpestate").value="",document.getElementById("snewpezip").value=""}function sAddPE(){sClearNewPE(),document.getElementById("SNEWPE").value="Y",document.getElementById("SPEID").value="",document.getElementById("iapNewPE").style.display="inline",document.getElementById("snewpedate").focus()}function sSelectP(){var e=document.getElementById("speparty").value.split(" ");document.getElementById("SDATE").value=e[0],document.getElementById("snonpediv2").style.display="none"}function sSelectE(){var e=document.getElementById("speevent").value.split(" ");document.getElementById("SDATE").value=e[0],document.getElementById("snonpediv2").style.display="none"}function sNewPEDateChg(){var e=document.getElementById("snewpedate").value;""!=e.trim()&&(document.getElementById("SDATE").value=e)}function sChangedNonPE(){var e=document.getElementById("ssaledate").value;""!=e.trim()&&(sClearNewPE(),document.getElementById("SDATE").value=e,document.getElementById("SPEID").value="")}function sShippingChg(){var e=parseFloat(document.getElementById("snetsale").value);isNaN(e)&&(e=0),sShowTotals(e)}function sTaxRateChg(){var e=parseFloat(document.getElementById("staxrate").value);if(isNaN(e))return document.getElementById("staxrate").style.color="red",sGenerateError("Entered tax rate is invalid."),void(e=0);var t=e/100,n=parseFloat(document.getElementById("snetsale").value);isNaN(n)&&(n=0);var l=parseFloat(document.getElementById("sshipping").value);isNaN(l)&&(l=0),0<t&&(sTax=(n+l)*t,document.getElementById("staxamt").value=number_format(sTax,2,".",",")),document.getElementById("STAXOVERRIDE").value="N",sShowTotals(n)}function sTaxAmtChg(){var e=parseFloat(document.getElementById("staxamt").value);if(isNaN(e))return document.getElementById("staxamt").style.color="red",sGenerateError("Entered tax amount is invalid."),void(e=0);var t=parseFloat(document.getElementById("snetsale").value);isNaN(t)&&(t=0),0<e&&(document.getElementById("staxamt").value=number_format(e,2,".",",")),document.getElementById("STAXOVERRIDE").value="Y",sShowTotals(t)}function sPayChg(){1==document.getElementById("spaycheck").checked&&document.getElementById("spaychkno").focus()}function sClrItemData(){return sClearItem(),document.getElementById("sitemcode").focus(),!1}function sClearItem(){document.getElementById("sitemcode").value="",document.getElementById("sitemdesc").value="",document.getElementById("sitemqty").value="",document.getElementById("sitemprice").value="",document.getElementById("snewitemcost").value="",document.getElementById("snewitemunits").value="",document.getElementById("snewitemcat").selectedIndex=0,document.getElementById("STHISITEMSOURCE").value=0}function sItemFocus(){""==document.getElementById("SDATE").value&&sGenerateError("Please select the appropriate Party, Event or enter the Sale Date above before entering items.")}function sItemDateOK(){var e="",t="N";return"Y"==document.getElementById("SNEWPE").value&&""==document.getElementById("snewpedate").value&&(t="Y",e="Enter the date for the new "+document.getElementById("STYPE").value),""==document.getElementById("SDATE").value&&(t="Y",e="P"==document.getElementById("STYPE").value?"Select a Party":"E"==document.getElementById("STYPE").value?"Select an Event":"Enter a valid Date"),"Y"==t&&(sGenerateError("<RESET>"),sGenerateError(e+=" before entering items.")),t}function sAddItem(){return"Y"!=sItemDateOK()&&(""==document.getElementById("sitemcode").value?(sGenerateError("Enter an item code then click Add."),document.getElementById("iapNewItem").style.display="inline",document.getElementById("sitemcode").focus(),!1):(sGenerateError("<RESET>"),"none"==document.getElementById("iapNewItem").style.display?(document.getElementById("sitemqty").value="",document.getElementById("sitemprice").value="",document.getElementById("snewitemunits").value="",document.getElementById("snewitemcost").value="",document.getElementById("snewitemcat").selectedIndex=0,document.getElementById("iapNewItem").style.display="inline",document.getElementById("sitemdesc").focus(),document.getElementById("STHISITEMSOURCE").value=0,!(document.getElementById("STHISITEMSTATUS").value="NEW")):void 0))}function sICodeClicked(e,t){if("Y"==sItemDateOK())return!1;if(""!=e){"EXISTING"==document.getElementById("STHISITEMSTATUS").value&&(document.getElementById("iapNewItem").style.display="none",sGenerateError("<RESET>"),document.getElementById("sitemdesc").value="");var n=(document.getElementById("STHISITEMSOURCE").value=t)+"|"+e+"~"+document.getElementById("SDATE").value;return iapPrepCall("/Ajax/iapGetDB","I#",n,sProcItem),!1}sGenerateError("Enter an item code or description then click Add Item!")}function sIDescClicked(){if("Y"==sItemDateOK())return!1;if(sDesc=document.getElementById("sitemdesc").value,""!=sDesc){"EXISTING"==document.getElementById("STHISITEMSTATUS").value&&(document.getElementById("iapNewItem").style.display="none",sGenerateError("<RESET>"),document.getElementById("sitemcode").value="");var e=sDesc+"~"+document.getElementById("SDATE").value;return iapPrepCall("/Ajax/iapGetDB","IN",e,sProcItem),!1}sGenerateError("Enter an item code or description then click Add Item!")}function sProcItem(e){if("NEW"!=document.getElementById("STHISITEMSTATUS").value)return 0==e?(sAddItem(),sGenerateError("This item was not found. Please enter all the information below."),!1):void sProcItemGood(e);sProcNewItem(e)}function sProcItemGood(e){document.getElementById("sitemcode").value=e.cat_item_code,document.getElementById("sitemdesc").value=e.cat_description,document.getElementById("sitemprice").value=number_format(e.prc_price,2,".",","),"CO"==e.SUPPID?document.getElementById("STHISITEMSOURCE").value=0:document.getElementById("STHISITEMSOURCE").value=e.cat_supplier_id,document.getElementById("STHISITEMSTATUS").value="EXISTING",document.getElementById("sitemqty").focus()}function sProcNewItem(e){0!=e&&sProcItemGood(e),e=document.getElementById("sitemcode").value,""!=document.getElementById("sitemcode").value?(sDesc=document.getElementById("sitemdesc").value,""!=sDesc?document.getElementById("sitemqty").focus():document.getElementById("sitemdesc").focus()):document.getElementById("sitemcode").focus()}function sRecordItem(){sGenerateError("<RESET>");var e="N";""==document.getElementById("sitemcode").value&&(document.getElementById("sitemcodelbl").style.color="red",sGenerateError("Item Code cannot be blank."),e="Y"),""==document.getElementById("sitemdesc").value&&(document.getElementById("sitemdesclbl").style.color="red",sGenerateError("Description cannot be blank."),e="Y"),""==document.getElementById("sitemqty").value&&(document.getElementById("sitemqtylbl").style.color="red",sGenerateError("Quantity cannot be blank."),e="Y");var t=parseInt(document.getElementById("sitemqty").value);isNaN(t)&&(document.getElementById("sitemqtylbl").style.color="red",sGenerateError("Quantity is invalid."),e="Y"),t<0&&(document.getElementById("sitemqtylbl").style.color="red",sGenerateError("Quantity cannot be negative. Use Returns to bring back an item."),e="Y"),""==document.getElementById("sitemprice").value&&(document.getElementById("sitempricelbl").style.color="red",sGenerateError("Selling Price cannot be blank."),e="Y");var n=parseFloat(document.getElementById("sitemprice").value);if(isNaN(n)&&(document.getElementById("sitempricelbl").style.color="red",sGenerateError("Selling Price is invalid."),e="Y"),"NEW"==document.getElementById("STHISITEMSTATUS").value){""==document.getElementById("sitemcode").value&&(document.getElementById("sitemcodelbl").style.color="red",sGenerateError("Item Code cannot be blank."),e="Y"),""==document.getElementById("snewitemunits").value&&(document.getElementById("snewitemunitslbl").style.color="red",sGenerateError("Saleable Units cannot be blank."),e="Y");var l=parseFloat(document.getElementById("snewitemunits").value);(isNaN(l)||l<1)&&(document.getElementById("snewitemunitslbl").style.color="red",sGenerateError("Saleable Units must be valid and > 0."),e="Y"),""==document.getElementById("snewitemcost").value&&(document.getElementById("snewitemcostlbl").style.color="red",sGenerateError("Cost cannot be blank."),e="Y");var d=parseFloat(document.getElementById("snewitemcost").value);isNaN(d)&&(document.getElementById("snewitemcostlbl").style.color="red",sGenerateError("Cost is invalid."),e="Y"),0==document.getElementById("snewitemcat").selectedIndex&&(document.getElementById("snewitemcatlbl").style.color="red",sGenerateError("Select a valid category for this item."),e="Y")}if("Y"==e)return sGenerateError("All item fields must be valid prior to clicking Record Item."),!1;document.getElementById("sitemcodelbl").style.color="#666666",document.getElementById("sitemdesclbl").style.color="#666666",document.getElementById("sitemqtylbl").style.color="#666666",document.getElementById("sitempricelbl").style.color="#666666",document.getElementById("snewitemunitslbl").style.color="#666666",document.getElementById("snewitemcostlbl").style.color="#666666",document.getElementById("snewitemcatlbl").style.color="#666666",sGenerateError("<RESET>");var m=document.getElementById("sitemcode").value,s=(t=parseInt(document.getElementById("sitemqty").value),parseFloat(document.getElementById("sitemprice").value)),o=parseFloat(t*s),a=parseFloat(document.getElementById("snetsale").value);isNaN(a)&&(a=0),a+=o;var u=document.getElementById("iapSold"),c=u.insertRow(-1),r=c.insertCell(0),y=c.insertCell(1),E=c.insertCell(2),i=c.insertCell(3),I=c.insertCell(4),g=c.insertCell(5),B=c.insertCell(6),p=c.insertCell(7),v=u.rows.length-1;c.setAttribute("id","Sold"+v,0);var S=document.getElementById("STHISITEMSTATUS").value;S=S.substr(0,1),r.innerHTML="<input type='hidden' id='recrow"+v+"' value='"+S+"'>",y.innerHTML="<img src='MyImages/Icons/DeleteRedSM.png' onclick='sDelSold("+v+"); return(false);'>&nbsp;&nbsp;",E.innerHTML=m.toUpperCase(),i.innerHTML=document.getElementById("sitemdesc").value,I.innerHTML=t,g.innerHTML=number_format(s,2,".",","),B.innerHTML=number_format(o,2,".",",");var T=document.getElementById("STHISITEMSOURCE").value;p.innerHTML="<input type='hidden' id='recsid"+v+"' value='|"+T+"|'>",sShowTotals(a);var f=document.getElementById("SNEWITEMINFO").value,w=m.toUpperCase(),h=document.getElementById("STHISITEMSTATUS").value,N=document.getElementById("snewitemunits").value,b=document.getElementById("snewitemcost").value,C=document.getElementById("snewitemcat").value,P=document.getElementById("STHISITEMSOURCE").value;return document.getElementById("SNEWITEMINFO").value=f+w+"~"+h+"~"+N+"~"+b+"~"+C+"~"+P+"|",sClearItem(),document.getElementById("STHISITEMSTATUS").value="",document.getElementById("iapNewItem").style.display="none",document.getElementById("sitemcode").focus(),!1}function sDelSold(e){var t="Sold"+e,n=document.getElementById(t),l=n.cells,d=parseFloat(l[6].innerHTML),m=parseFloat(document.getElementById("snetsale").value);return isNaN(m)&&(m=0),sShowTotals(m-=d),n.parentNode.removeChild(n),!1}function sShowTotals(e){document.getElementById("snetsale").value=number_format(e,2,".",",");var t=parseFloat(document.getElementById("sshipping").value);if(isNaN(t)&&(t=0),"Y"==document.getElementById("STAXOVERRIDE").value)var n=parseFloat(document.getElementById("staxamt").value);else{n=0;var l=parseFloat(document.getElementById("staxrate").value);0<l&&(n=(e+t)*(l/100))}document.getElementById("staxamt").value=number_format(n,2,".",",");var d=e+n+t;document.getElementById("stotalsale").value=number_format(d,2,".",",")}function sClearForm(){document.getElementById("scustomers").value="",document.getElementById("scustomers").readOnly=!1,sClearNewCust(),document.getElementById("stypeparty").checked=!0,document.getElementById("speparty").value="",document.getElementById("speparty").style.display="inline",document.getElementById("speevent").value="",document.getElementById("speevent").style.display="none",sClearNewPE(),document.getElementById("svendord").value="",document.getElementById("ssaledate").value="",document.getElementById("smileage").value="",document.getElementById("sotherexp").value="",document.getElementById("sexpexplain").value="",document.getElementById("ssaleloc").value="",document.getElementById("spaycash").checked=!0,document.getElementById("spaychkno").value="",document.getElementById("staxamt").value="",document.getElementById("sshipping").value="",document.getElementById("strackno").value="",document.getElementById("scomment").value="",document.getElementById("snetsale").value="",document.getElementById("stotalsale").value="",document.getElementById("sprtrec").style.display="none",document.getElementById("SALEID").value="",document.getElementById("SDATE").value="",document.getElementById("STAXOVERRIDE").value="N",document.getElementById("STYPE").value="Party",document.getElementById("SNEWCUST").value="N",document.getElementById("SPEID").value="",document.getElementById("SSELPE").value="",document.getElementById("SNEWPE").value="N",document.getElementById("SNEWITEMINFO").value="",document.getElementById("STHISITEMSTATUS").value="",document.getElementById("SUPDATETYPE").value="",sClearItem();for(var e=document.getElementById("iapSold").rows.length;1<e;)document.getElementById("iapSold").deleteRow(e-1),e--;return!1}function sSendForm(){if(""!=document.getElementById("sitemcode").value||""!=document.getElementById("sitemdesc").value)return sGenerateError("An Item has not been Recorded. Either click Record Item or clear the data."),document.getElementById("sitemcode").focus(),!1;for(var e="",t=document.getElementById("iapSold"),n="Y",l=1,d=t.rows.length;l<d;l++){"Y"==n?n="N":e+="|";for(var m=2,s=t.rows[l].cells.length;m<s-1;m++)e=e+t.rows[l].cells[m].innerHTML+"~";var o=t.rows[l].cells[s-1].innerHTML,a=o.indexOf("|")+1,u=o.lastIndexOf("|")-a;e=e+o.substr(a,u)+"~"}return document.getElementById("IAPDATA").value=e,!0}function sGenerateError(e){if("<RESET>"!=e){var t=document.getElementById("sitemerror").innerHTML;document.getElementById("sitemerror").innerHTML=t+"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+e}else document.getElementById("sitemerror").innerHTML=" "}$(function(){$("#sSaleList").autocomplete({source:sSList,minLength:0,change:function(e,t){if(""==document.getElementById("sSaleList").value)document.getElementById("sError").style.display="inline",document.getElementById("sSaleList").focus();else{var n=t.item.saleid;iapPrepCall("/Ajax/iapGetDB","S#",n,sProcSale),document.getElementById("sSaleList").value="",document.getElementById("sError").style.display="none",document.getElementById("sdetail").style.display="inline",document.getElementById("scustomers").value=t.item.custname,document.getElementById("scustomers").readOnly=!0,document.getElementById("srefundbtn").style.display="inline",document.getElementById("scustomers").focus()}}}),$("#scustomers").autocomplete({source:sCList,minLength:0,change:function(e,t){if(""==document.getElementById("scustomers").value)document.getElementById("cError").style.display="inline",document.getElementById("scustomers").focus();else{var n=t.item.custid,l=document.getElementById("scustomers").value;if(sClearNewCust(),document.getElementById("scustomers").value=l,document.getElementById("SNEWCUST").value="N",document.getElementById("iapNewCust").style.display="none",sCustRet=iapPrepCall("/Ajax/iapGetDB","C#",n,sProcCust),document.getElementById("STAXRATE").value!=t.item.taxrate){document.getElementById("STAXREGION").value=t.item.taxreg,document.getElementById("STAXRATE").value=t.item.taxrate,document.getElementById("staxregion").innerHTML=t.item.taxreg;var d=100*t.item.taxrate;document.getElementById("staxrate").value=number_format(d,2,".",""),document.getElementById("STAXOVERRIDE").value="N";var m=parseFloat(document.getElementById("snetsale").value);isNaN(m)&&(m=0),sShowTotals(m)}}}}),$("#speparty").autocomplete({source:sPList,minLength:0,change:function(e,t){if(""==document.getElementById("speparty").value)document.getElementById("parError").style.display="inline",document.getElementById("speparty").focus();else if(sSelectP(),document.getElementById("SSELPE").value=t.item.id,document.getElementById("SNEWPE").value="S",document.getElementById("STAXRATE").value!=t.item.taxrate){document.getElementById("STAXREGION").value=t.item.taxreg,document.getElementById("STAXRATE").value=t.item.taxrate,document.getElementById("staxregion").innerHTML=t.item.taxreg;var n=100*t.item.taxrate;document.getElementById("staxrate").value=number_format(n,2,".",""),document.getElementById("STAXOVERRIDE").value="N";var l=parseFloat(document.getElementById("snetsale").value);isNaN(l)&&(l=0),sShowTotals(l)}}}),$("#speevent").autocomplete({source:sEList,minLength:0,change:function(e,t){if(""==document.getElementById("speevent").value)document.getElementById("pevtError").style.display="inline",document.getElementById("speevent").focus();else if(sSelectE(),document.getElementById("SSELPE").value=t.item.id,document.getElementById("SNEWPE").value="S",document.getElementById("STAXRATE").value!=t.item.taxrate){document.getElementById("STAXREGION").value=t.item.taxreg,document.getElementById("STAXRATE").value=t.item.taxrate,document.getElementById("staxregion").innerHTML=t.item.taxreg;var n=100*t.item.taxrate;document.getElementById("staxrate").value=number_format(n,2,".",""),document.getElementById("STAXOVERRIDE").value="N";var l=parseFloat(document.getElementById("snetsale").value);isNaN(l)&&(l=0),sShowTotals(l)}}}),$("#sitemcode").autocomplete({source:sItemList,minLength:0,change:function(e,t){if(t.item){var n=t.item.cd;l=t.item.src}else{if(""==(n=document.getElementById("sitemcode").value))return void sGenerateError("Enter an item code or description then click Add Item!");var l=0}sICodeClicked(n,l)}}),$("#sitemdesc").autocomplete({source:sDescList,minLength:0,change:function(e,t){t.item?sICodeClicked(t.item.cd,t.item.src):sIDescClicked()}})});