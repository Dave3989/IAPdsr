function cAddClicked(){cblankCustomer(),document.getElementById("CSTATUS").value="NEW",document.getElementById("cdetail").style.display="block",document.getElementById("cname").focus()}function cblankCustomer(){document.getElementById("cname").value="",document.getElementById("cname").focus(),document.getElementById("cbirth").value="",document.getElementById("canniv").value="",document.getElementById("cstreet").value="",document.getElementById("ccity").value="",document.getElementById("cstate").value="",document.getElementById("czip").value="",document.getElementById("cmap").style.display="none",document.getElementById("cphone").value="",document.getElementById("cemail").value="",document.getElementById("cfacebk").value="",document.getElementById("cnewsltr").checked=!0,document.getElementById("cfollowcons").checked=!1,document.getElementById("cfollowparty").checked=!1,document.getElementById("cmetdate").value="",document.getElementById("cmetat").value="",document.getElementById("cnotes").value="",document.getElementById("CUPDATETYPE").value="NEW",document.getElementById("CCUSTNO").value="";for(var e=document.getElementById("csalestbl").rows.length;4<e;)document.getElementById("csalestbl").deleteRow(e-1),e--;return document.getElementById("csalestbl").style.display="none",!0}function cGoClicked(){cNm=document.getElementById("cCustList").value,""==cNm?(cEm=document.getElementById("cEmailList").value,""==cEm?document.getElementById("cError").style.display="block":cgetEmail()):cgetCust()}function cgetCust(){var e=document.getElementById("cCustList").value;iapPrepCall("/Ajax/iapGetDB","CN",e,cProcCustomer),document.getElementById("cCustList").value="","NEW"!=document.getElementById("CSTATUS").value&&cShowItems(),document.getElementById("cname").focus()}function cgetEmail(){var e=document.getElementById("cEmailList").value;iapPrepCall("/Ajax/iapGetDB","CE",e,cProcCustomer),document.getElementById("cEmailList").value="","NEW"!=document.getElementById("CSTATUS").value&&cShowItems(),document.getElementById("cname").focus()}function cgetPhone(){var e=document.getElementById("cPhoneList").value;iapPrepCall("/Ajax/iapGetDB","CP",e,cProcCustomer),document.getElementById("cPhoneList").value="","NEW"!=document.getElementById("CSTATUS").value&&cShowItems(),document.getElementById("cname").focus()}function cProcCustomer(e){if(0!=e){document.getElementById("CSTATUS").value="EXISTING",document.getElementById("cname").value=e.cust_name,document.getElementById("cstreet").value=e.cust_street,document.getElementById("ccity").value=e.cust_city,document.getElementById("cstate").value=e.cust_state,document.getElementById("czip").value=e.cust_zip;var t=e.cust_street.trim()+"| "+e.cust_city.trim()+", "+e.cust_state.trim()+" "+e.cust_zip.trim();return",  "==(t=t.replace("||","|"))?document.getElementById("cmap").style.display="none":(t="https://www.google.com/maps/place/"+(t=(t=t.replace(" ","+")).replace("|",",")),document.getElementById("cmapa").setAttribute("href",t),document.getElementById("cmap").style.display="inline"),document.getElementById("cemail").value=e.cust_email,document.getElementById("cfacebk").value=e.cust_facebook,empty(e.cust_phone)?document.getElementById("cphone").value="":document.getElementById("cphone").value=e.cust_phone,empty(e.cust_birthday)?document.getElementById("cbirth").value="":document.getElementById("cbirth").value=moment(e.cust_birthday).format("MM/DD"),empty(e.cust_anniversary)?document.getElementById("canniv").value="":document.getElementById("canniv").value=moment(e.cust_anniversary).format("MM/DD"),document.getElementById("cnewsltr").checked=!1,"Y"==e.cust_newsletter&&(document.getElementById("cnewsltr").checked=!0),document.getElementById("cfollowcons").checked=!1,"Y"==e.cust_followup_consultant&&(document.getElementById("cfollowcons").checked=!0),document.getElementById("cfollowparty").checked=!1,"Y"==e.cust_followup_party&&(document.getElementById("cfollowparty").checked=!0),"0000-00-00"==e.cust_met_date?document.getElementById("cmetdate").value="":document.getElementById("cmetdate").value=moment(e.cust_met_date).format("MM/DD/YYYY"),empty(e.cust_met_at)?document.getElementById("cmetat").value="":document.getElementById("cmetat").value=e.cust_met_at,empty(e.cust_notes)?document.getElementById("cnotes").value="":document.getElementById("cnotes").value=e.cust_notes,document.getElementById("CUPDATETYPE").value="EXISTING",document.getElementById("CCUSTNO").value=e.cust_no,document.getElementById("cError").style.display="none",document.getElementById("cdetail").style.display="block",!0}document.getElementById("cError").style.display="inline"}function sSetType(e){switch(e){case"P":document.getElementById("CTYPE").value="Party",document.getElementById("cpelabel").innerHTML="Select a Party: ",document.getElementById("cpelabel").style.display="inline",document.getElementById("cpeevent").style.display="none",document.getElementById("cpeparty").style.display="inline";break;case"E":document.getElementById("CTYPE").value="Event",document.getElementById("cpelabel").innerHTML="Select an Event: ",document.getElementById("cpelabel").style.display="inline",document.getElementById("cpeparty").style.display="none",document.getElementById("cpeevent").style.display="inline";break;case"N":document.getElementById("CTYPE").value="Neither",document.getElementById("cpelabel").innerHTML=" ",document.getElementById("cpelabel").style.display="none",document.getElementById("cpeevent").style.display="none",document.getElementById("cpeparty").style.display="none"}}function cShowItems(){for(var e=document.getElementById("csalestbl").rows.length;4<e;)document.getElementById("csalestbl").deleteRow(e-1),e--;var t=document.getElementById("CCUSTNO").value;iapPrepCall("/Ajax/iapGetDB","S2",t,cProcItems)}function cProcItems(e){var t=0,n=0,l=0,s=0;if(0!=e){for(var c=document.getElementById("csalestbl"),a="",m="",i=e.length,r=0;r<i;r++){var o=e[r],d=o.saledet_item_code;if(o.CO_description)u=o.CO_description;else var u=o.SUPP_description;if(sKey=moment(o.sale_date).format("MM/DD/YYYY")+o.pe_sponsor+o.saledet_sid,sKey!=a){if(""!=a){(W=c.insertRow(-1)).setAttribute("id","ItemT2",0);var y=W.insertCell(0),p=W.insertCell(1),g=W.insertCell(2),E=W.insertCell(3),b=W.insertCell(4),I=W.insertCell(5),B=W.insertCell(6),v=W.insertCell(7);I.setAttribute("style","text-align:right;"),B.setAttribute("style","text-align:right;"),y.innerHTML="&nbsp;",p.innerHTML="&nbsp;",g.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Total This Sale",E.innerHTML="&nbsp;",b.innerHTML="&nbsp;",I.innerHTML="&nbsp;",B.innerHTML="&nbsp;",v.innerHTML="&nbsp;",I.innerHTML=number_format(t,2,".",","),B.innerHTML=number_format(n,2,".",","),v.innerHTML="",t=n=0}a=sKey;var T="N";switch(o.pe_type){case"E":m="Event",T="E";break;case"P":m="Party "+o.pe_party_no.toString(),T="P";break;case"I":m="Sale To Individual",0==empty(o.pe_party_no)&&(T="P",m=m.concat(" For Party ",o.pe_party_no.toString()));break;case"F":m="Facebook Party - Party Number "+o.pe_party_no.toString(),T="P";break;case"W":m="Sale From Website",0==empty(o.pe_party_no)&&(T="P",m=m.concat(" For Party ",o.pe_party_no.toString()));break;case"X":m="Exchange";break;case"O":m="Other Type Sale";break;default:m="Unknown Type"}var C=c.insertRow(-1);C.setAttribute("id","ItemB"+r,0);var _=C.insertCell(0),L=C.insertCell(1),h=C.insertCell(2),f=C.insertCell(3);f.setAttribute("colSpan",5),_.innerHTML="&nbsp;",L.innerHTML="&nbsp;",h.innerHTML="&nbsp;",f.innerHTML="&nbsp;";var M=c.insertRow(-1);M.setAttribute("id","Item2"+r,0);var H=M.insertCell(0),P=M.insertCell(1),S=M.insertCell(2),A=M.insertCell(3);A.setAttribute("colSpan",5);var w=H.innerHTML="",k="";"E"==T&&(w=w.concat("<a href='?page_id=356&action=selected&peid=",o.sale_peid.toString(),"'>")),"P"==T&&(w=w.concat("<a href='?page_id=356&action=selected&peid=",o.sale_peid.toString(),"'>")),"N"!=T&&(k="</a>"),P.innerHTML=P.innerHTML.concat(w,moment(o.sale_date).format("MM/DD/YYYY"),k),S.innerHTML=o.pe_sponsor,A.innerHTML=m}var N=c.insertRow(-1);N.setAttribute("id","Item"+r,0);var Y=N.insertCell(0),D=N.insertCell(1),x=N.insertCell(2),U=N.insertCell(3),F=N.insertCell(4),R=N.insertCell(5),G=N.insertCell(6),O=N.insertCell(7);x.setAttribute("style","padding-left:10px;"),U.setAttribute("style","text-align:right;"),F.setAttribute("style","text-align:right;"),R.setAttribute("style","text-align:right;"),G.setAttribute("style","text-align:right;"),Y.innerHTML="",D.innerHTML="&nbsp;&nbsp;<a href='?page_id=141&action=selected&item="+d+"'>"+d+"</a>",x.innerHTML=u,U.innerHTML=number_format(o.saledet_quantity,0,".",","),F.innerHTML=number_format(o.saledet_price,2,".",","),R.innerHTML=number_format(o.saledet_total_price,2,".",","),G.innerHTML=number_format(o.saledet_total_cost,2,".",","),O.innerHTML="",sItemTPrice=parseFloat(o.saledet_total_price),isNaN(sItemTPrice)&&(sItemTPrice=0),t+=sItemTPrice,l+=sItemTPrice,sItemTCost=parseFloat(o.saledet_total_cost),isNaN(sItemTCost)&&(sItemTCost=0),n+=sItemTCost,s+=sItemTCost}var W;(W=c.insertRow(-1)).setAttribute("id","ItemT2",0);y=W.insertCell(0),p=W.insertCell(1),g=W.insertCell(2),E=W.insertCell(3),b=W.insertCell(4),I=W.insertCell(5),B=W.insertCell(6),v=W.insertCell(7);I.setAttribute("style","text-align:right;"),B.setAttribute("style","text-align:right;"),y.innerHTML="&nbsp;",p.innerHTML="&nbsp;",g.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Total This Sale",E.innerHTML="&nbsp;",b.innerHTML="&nbsp;",I.innerHTML="&nbsp;",B.innerHTML="&nbsp;",v.innerHTML="&nbsp;",I.innerHTML=number_format(t,2,".",","),B.innerHTML=number_format(n,2,".",","),v.innerHTML="";var $=c.insertRow(-1);$.setAttribute("id","ItemT1",0);var j=$.insertCell(0),z=$.insertCell(1),K=$.insertCell(2),X=$.insertCell(3),q=$.insertCell(4),V=$.insertCell(5),J=$.insertCell(6),Q=$.insertCell(7);j.innerHTML="&nbsp;",z.innerHTML="&nbsp;",K.innerHTML="&nbsp;",X.innerHTML="&nbsp;",q.innerHTML="&nbsp;",V.innerHTML="&nbsp;",J.innerHTML="&nbsp;",Q.innerHTML="&nbsp;";var Z=c.insertRow(-1);Z.setAttribute("id","ItemT2",0);var ee=Z.insertCell(0),te=Z.insertCell(1),ne=Z.insertCell(2),le=Z.insertCell(3),se=Z.insertCell(4),ce=Z.insertCell(5),ae=Z.insertCell(6),me=Z.insertCell(7);ce.setAttribute("style","text-align:right;"),ae.setAttribute("style","text-align:right;"),ee.innerHTML="&nbsp;",te.innerHTML="&nbsp;",ne.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Total For Customer",le.innerHTML="&nbsp;",se.innerHTML="&nbsp;",ce.innerHTML="&nbsp;",ae.innerHTML="&nbsp;",me.innerHTML="&nbsp;",ce.innerHTML=number_format(l,2,".",","),ae.innerHTML=number_format(s,2,".",","),me.innerHTML="",document.getElementById("csalestbl").style.display="block"}else document.getElementById("csalestbl").style.display="none"}function cGenerateVCard(e){var t=require("vcards-js");(t=t()).firstName=e.cust_first_name,t.lastName=e.cust_last_name,t.birthday=new Date(e.cust_birthday),t.cellPhone=e.cust_phone,t.email=e.cust_email,t.homeAddress.label="Home Address",t.homeAddress.street=e.cust_street,t.homeAddress.city=e.cust_city,t.homeAddress.stateProvince=e.cust_state,t.homeAddress.postalCode=e.cust_zip,t.homeAddress.countryRegion="United States",t.version="3.0",t.saveToFile("./test.vcf"),console.log(t.getFormattedString())}function empty(e){switch(e){case"":case 0:case"0":case null:case!1:case void 0===this:return!0;default:return!1}}$(function(){$("#cCustList").autocomplete({source:acCustomers,minLength:0,change:function(e,t){cgetCust()}}),$("#cEmailList").autocomplete({source:acEmails,minLength:0,change:function(e,t){cgetEmail()}}),$("#cPhoneList").autocomplete({source:acPhones,minLength:0,change:function(e,t){cgetPhone()}}),$("#cpeparty").autocomplete({source:cPList,minLength:0,change:function(e,t){if(""==document.getElementById("cpeparty").value)document.getElementById("cparError").style.display="inline",document.getElementById("cpeparty").focus();else{t.item.id;var n=document.getElementById("cpeparty").value,l=n.split(" ");document.getElementById("cmetdate").value=l[0],document.getElementById("cmetat").value=n,document.getElementById("CSELPE").value=t.item.id}}}),$("#cpeevent").autocomplete({source:cEList,minLength:0,change:function(e,e){if(""==document.getElementById("cpeevent").value)document.getElementById("cevtError").style.display="inline",document.getElementById("cpeevent").focus();else{e.item.id;var t=document.getElementById("cpeevent").value,n=t.split(" ");document.getElementById("cmetdate").value=n[0],document.getElementById("cmetat").value=t,document.getElementById("CSELPE").value=e.item.id}}})});