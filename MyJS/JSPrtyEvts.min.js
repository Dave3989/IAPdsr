function peAddClicked(){peBlankPERec(),document.getElementById("pedetail").style.display="inline",document.getElementById("peparty").focus()}function peBlankPERec(){document.getElementById("petypeparty").checked=!0,document.getElementById("pepartycomp").style.display="none",document.getElementById("peparty").value="",document.getElementById("pedate").value="",document.getElementById("pestart").value="",document.getElementById("peend").value="",document.getElementById("pesponsor").value="",document.getElementById("pecustomer").value="",document.getElementById("pestreet").value="",document.getElementById("pecity").value="",document.getElementById("pestate").value="",document.getElementById("pezip").value="",document.getElementById("peurl").value="",document.getElementById("pec1name").value="",document.getElementById("pec1email").value="",document.getElementById("pec1phone").value="",document.getElementById("pec2name").value="",document.getElementById("pec2email").value="",document.getElementById("pec2phone").value="",document.getElementById("pemiles").value="",document.getElementById("pespaceexp").value="",document.getElementById("peotherexp").value="",document.getElementById("peexplexp").value="",document.getElementById("peaddcal").checked=!0,document.getElementById("peeventno").style.display="none",document.getElementById("pecomments").value="",document.getElementById("pesaletottitle").style.display="none";for(var e=document.getElementById("pesalestbl").rows.length;e>1;)document.getElementById("pesalestbl").deleteRow(e-1),e--;return document.getElementById("petnet").innerHTML=" ",document.getElementById("petship").innerHTML=" ",document.getElementById("pettax").innerHTML=" ",document.getElementById("petcost").innerHTML=" ",document.getElementById("petprofit").innerHTML=" ",document.getElementById("pettotal").innerHTML=" ",document.getElementById("pesalestbl").style.display="none",document.getElementById("PEID").value="",document.getElementById("PESALES").value="",document.getElementById("PEHOSTESSID").value=0,document.getElementById("PETAXREGION").value="",document.getElementById("PETAXRATE").value=0,document.getElementById("PEUPDATETYPE").value="NEW",pesetpartyon(),!0}function pGoClicked(){}function peGetPE(e){peBlankPERec();iapPrepCall("/Ajax/iapGetDB","E#",e,peProcPartyEvent)}function peProcPartyEvent(e){if(0==e)peBlankPERec();else{"E"==e.pe_type?(document.getElementById("petypeevent").checked=!0,pesetpartyoff(),document.getElementById("peparty").value=""):(document.getElementById("petypeparty").checked=!0,pesetpartyon(),document.getElementById("PEHOSTESSID").value=e.pe_party_hostess,document.getElementById("peparty").value=e.pe_party_no,"Y"==e.pe_party_complete&&(document.getElementById("pepartycomp").style.display="inline")),document.getElementById("PEPARTYCOMP").value=e.pe_party_complete,document.getElementById("pedate").value=moment(e.pe_date).format("MM/DD/YYYY");var t=e.pe_start_time;document.getElementById("pestart").value=t.substr(0,5);var n=e.pe_end_time;document.getElementById("peend").value=n.substr(0,5),document.getElementById("pesponsor").value=e.pe_sponsor,document.getElementById("pecustomer").value=e.pe_sponsor,document.getElementById("pestreet").value=e.pe_street,document.getElementById("pecity").value=e.pe_city,document.getElementById("pestate").value=e.pe_state,document.getElementById("pezip").value=e.pe_zip;var l=e.pe_street.trim()+"| "+e.pe_city.trim()+", "+e.pe_state.trim()+" "+e.pe_zip.trim();",  "==(l=l.replace("||","|"))?document.getElementById("pemap").style.display="none":(l="https://www.google.com/maps/place/"+(l=(l=l.replace(" ","+")).replace("|",",")),document.getElementById("pemapa").setAttribute("href",l),document.getElementById("pemap").style.display="inline"),document.getElementById("peurl").value=e.pe_website,document.getElementById("pec1name").value=e.pe_contact1,document.getElementById("pec1email").value=e.pe_c1email,document.getElementById("pec1phone").value=e.pe_c1phone,document.getElementById("pec2name").value=e.pe_contact2,document.getElementById("pec2email").value=e.pe_c2email,document.getElementById("pec2phone").value=e.pe_c2phone,e.pe_event_id>0?(document.getElementById("peaddcal").checked=!0,document.getElementById("peeventno").innerHTML="To edit the event use Event Id "+e.pe_event_id):(document.getElementById("peaddcal").checked=!1,document.getElementById("peeventno").innerHTML=""),document.getElementById("pemiles").value=number_format(e.pe_mileage,2,".",","),"E"==e.pe_type&&(document.getElementById("pespaceexp").value=number_format(e.pe_space_charge,2,".",",")),document.getElementById("peotherexp").value=number_format(e.pe_other_expenses,2,".",","),document.getElementById("peexplexp").value=e.pe_exp_explained,e.pe_sales_cnt>0&&("E"==e.pe_type?document.getElementById("pesaletotname").innerHTML="Sales For This Event":"P"==e.pe_type?document.getElementById("pesaletotname").innerHTML="Sales For This Party":"F"==e.pe_type&&(document.getElementById("pesaletotname").innerHTML="Sales For This Facebook Party"),gbl_net_sales=e.pe_net_sales,gbl_cost_of_items=e.pe_cost_of_items,gbl_profit=e.pe_profit,gbl_shipping=e.pe_shipping,gbl_sales_tax=e.pe_sales_tax,gbl_total_sales=e.pe_total_sales,document.getElementById("pesaletottitle").style.display="block"),document.getElementById("pecomments").value=e.pe_comment,document.getElementById("PEID").value=e.pe_id,document.getElementById("PESALES").value=e.pe_sales_cnt,document.getElementById("PETAXREGION").value=e.tax_combined_rate,document.getElementById("PETAXRATE").value=e.tax_region_name,document.getElementById("PEUPDATETYPE").value="EXISTING"}return!0}function peShowSales(e){iapPrepCall("/Ajax/iapGetDB","SP",e,peProcSales)}function peProcSales(e){for(var t=document.getElementById("pesalestbl").rows.length;t>1;)document.getElementById("pesalestbl").deleteRow(t-1),t--;if(0==e)return document.getElementById("pesalestbl").style.display="none",void(document.getElementById("PESALES").value=0);document.getElementById("PESALES").value=e.length;for(var n=document.getElementById("pesalestbl"),l=0,m=e.length;l<m;l++){var d=n.insertRow(-1);d.setAttribute("id","Sale"+l,0);var p=d.insertCell(0),a=d.insertCell(1),o=d.insertCell(2),u=d.insertCell(3),s=d.insertCell(4),r=d.insertCell(5),c=d.insertCell(6),i=d.insertCell(7),y=d.insertCell(8),g=d.insertCell(9);o.setAttribute("style","text-align:right;"),u.setAttribute("style","text-align:right;"),s.setAttribute("style","text-align:right;"),r.setAttribute("style","text-align:right;"),c.setAttribute("style","text-align:right;"),i.setAttribute("style","text-align:right;"),y.setAttribute("style","text-align:right;");var E=e[l];p.innerHTML="",a.innerHTML="<a href='?page_id=291&action=selected&sale="+E.sale_id+"'>"+E.cust_name+"</a>",o.innerHTML=number_format(E.sale_net,2,".",","),u.innerHTML=number_format(E.sale_shipping,2,".",","),s.innerHTML=number_format(E.sale_sales_tax,2,".",","),r.innerHTML=number_format(E.sale_total_amt,2,".",","),c.innerHTML=number_format(E.sale_item_cost,2,".",","),i.innerHTML=number_format(E.sale_profit,2,".",","),g.innerHTML=""}var I=n.insertRow(-1);I.setAttribute("id","SaleT1",0);var B=I.insertCell(0),_=I.insertCell(1),v=I.insertCell(2),b=I.insertCell(3),T=I.insertCell(4),_=I.insertCell(5),h=I.insertCell(6),f=I.insertCell(7),P=I.insertCell(8),L=I.insertCell(9);B.innerHTML="&nbsp;",_.innerHTML="&nbsp;",v.innerHTML="&nbsp;",b.innerHTML="&nbsp;",T.innerHTML="&nbsp;",_.innerHTML="&nbsp;",h.innerHTML="&nbsp;",f.innerHTML="&nbsp;",P.innerHTML="&nbsp;",L.innerHTML="&nbsp;";var H=n.insertRow(-1);H.setAttribute("id","SaleT2",0);var M=H.insertCell(0),C=H.insertCell(1),S=H.insertCell(2),x=H.insertCell(3),A=H.insertCell(4),w=H.insertCell(5),R=H.insertCell(6),k=H.insertCell(7),D=H.insertCell(8),Y=H.insertCell(9);S.setAttribute("style","text-align:right;"),x.setAttribute("style","text-align:right;"),A.setAttribute("style","text-align:right;"),w.setAttribute("style","text-align:right;"),R.setAttribute("style","text-align:right;"),k.setAttribute("style","text-align:right;"),M.innerHTML="",C.innerHTML="Total All Sales:",S.innerHTML=number_format(gbl_net_sales,2,".",","),x.innerHTML=number_format(gbl_shipping,2,".",","),A.innerHTML=number_format(gbl_sales_tax,2,".",","),w.innerHTML=number_format(gbl_total_sales,2,".",","),R.innerHTML=number_format(gbl_cost_of_items,2,".",","),k.innerHTML=number_format(gbl_profit,2,".",","),D.innerHTML="",Y.innerHTML="",document.getElementById("pesalestbl").style.display="inline"}function pesetpartyon(){return document.getElementById("pepartycomp").style.display="none","Y"==document.getElementById("PEPARTYCOMP").value&&(document.getElementById("pepartycomp").style.display="inline"),document.getElementById("pepartylbl").innerHTML="Party Number: ",document.getElementById("peparty").type="text",document.getElementById("pesponsorlbl").innerHTML="Hostess:",document.getElementById("pesponsor").type="hidden",document.getElementById("pecustomer").type="text",document.getElementById("peparty").focus(),!1}function pesetpartyoff(){return document.getElementById("pepartycomp").style.display="none",document.getElementById("pepartylbl").innerHTML=" ",document.getElementById("peparty").type="hidden",document.getElementById("pesponsorlbl").innerHTML="Sponsor:",document.getElementById("pesponsor").type="text",document.getElementById("pecustomer").type="hidden",document.getElementById("PEHOSTESSID").value=0,document.getElementById("pedate").focus(),!1}function peProcCustomer(e){0==e?(document.getElementById("pestreet").value="",document.getElementById("pecity").value="",document.getElementById("pestate").value="",document.getElementById("pezip").value="",document.getElementById("pec1name").value="",document.getElementById("pec1email").value="",document.getElementById("pec1phone").value="",document.getElementById("PEHOSTESSID").value=0):(document.getElementById("pestreet").value=e.cust_street,document.getElementById("pecity").value=e.cust_city,document.getElementById("pestate").value=e.cust_state,document.getElementById("pezip").value=e.cust_zip,document.getElementById("pec1name").value=e.cust_name,document.getElementById("pec1email").value=e.cust_email,document.getElementById("pec1phone").value=e.cust_phone,document.getElementById("PEHOSTESSID").value=e.cust_no)}var gbl_net_sales=0,gbl_cost_of_items=0,gbl_profit=0,gbl_shipping=0,gbl_sales_tax=0,gbl_total_sales=0;$(function(){$("#pPEList").autocomplete({source:pAllPEs,minLength:0,change:function(e,t){if(document.getElementById("pesavenew").style.display="none",document.getElementById("pedelete").style.display="none",null==t.item)document.getElementById("pError").style.display="inline";else{document.getElementById("pesponsor").value="",document.getElementById("pecustomer").value="";var n=t.item.id;peGetPE(n),document.getElementById("PESALES").value>0&&peShowSales(n),document.getElementById("pPEList").value="",document.getElementById("pError").style.display="none",document.getElementById("pedetail").style.display="inline",document.getElementById("pesavenew").style.display="inline",document.getElementById("pedelete").style.display="inline"}}}),$("#pecustomer").autocomplete({source:pCusts,minLength:0,change:function(e,t){if(null==t.item)peProcCustomer(0),document.getElementById("pec1name").value=document.getElementById("pecustomer").value;else{var n=t.item.id;iapPrepCall("/Ajax/iapGetDB","C#",n,peProcCustomer)}}})});